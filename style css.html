// 获取 DOM 元素
const mainModal = document.getElementById('main-modal');
const phoneModal = document.getElementById('phone-modal');
const downloadVCard = document.getElementById('download-vcard');
const closeMainModal = document.getElementById('close-main-modal');
const closePhoneModal = document.getElementById('close-phone-modal');
const sendPhoneButton = document.getElementById('send-phone');
const confirmPhone = document.getElementById('confirm-phone');
const cancelPhone = document.getElementById('cancel-phone');
const phoneError = document.getElementById('phone-error');
const phoneSuccess = document.getElementById('phone-success');

// vCard 按钮点击事件
downloadVCard.addEventListener('click', () => {
  mainModal.style.display = 'flex';
});

// 主 Modal 关闭逻辑
closeMainModal.addEventListener('click', () => {
  mainModal.style.display = 'none';
});

// 点击发送到手机按钮，打开 Phone Modal
sendPhoneButton.addEventListener('click', () => {
  mainModal.style.display = 'none';
  phoneModal.style.display = 'flex';
  resetPhoneModal();
});

// Phone Modal 关闭逻辑
closePhoneModal.addEventListener('click', () => {
  phoneModal.style.display = 'none';
});

// 点击取消按钮，关闭 Phone Modal
cancelPhone.addEventListener('click', () => {
  phoneModal.style.display = 'none';
});

// 确认发送到手机逻辑
confirmPhone.addEventListener('click', () => {
  resetPhoneModal();
  try {
    // 模拟文件下载成功的逻辑
    phoneModal.style.display = 'none';
    window.location.href = 'OliverF.vcf';
    phoneSuccess.textContent = 'Contact successfully saved to your phone.';
    phoneSuccess.style.display = 'block';
    phoneError.style.display = 'none';
    setTimeout(() => {
      phoneSuccess.style.display = 'none';
    }, 3000);
  } catch (error) {
    // 模拟文件下载失败的逻辑
    console.error("Error during file download:", error);
    phoneError.textContent = 'Failed to save contact.';
    phoneError.style.display = 'block';
    phoneSuccess.style.display = 'none';
    setTimeout(() => {
      phoneError.style.display = 'none';
    }, 3000);
  }
});

// 重置 Phone Modal
function resetPhoneModal() {
  phoneError.style.display = 'none';
  phoneSuccess.style.display = 'none';
}

// 点击页面外部区域关闭 Modal
window.addEventListener('click', (event) => {
  if (event.target === mainModal) {
    mainModal.style.display = 'none';
  }
  if (event.target === phoneModal) {
    phoneModal.style.display = 'none';
  }
});

// Carousel 数据和逻辑
const carouselTrack = document.getElementById('carouselTrack');
const modulesData = [
  {
    href: "https://wa.me/12817839998",
    img: "WeChat Logo.png",
    text1: "WeChat",
    text2: "Oliver Fang"
  },
  {
    href: "https://wa.me/12817839998",
    img: "WhatsApp Logo.png",
    text1: "WhatsApp",
    text2: "+1 281 783 9998"
  },
  {
    href: "mailto:sales@oliverfr.com",
    img: "Email Logo.png",
    text1: "Email",
    text2: "sales@oliverfr.com"
  },
  {
    href: "tel:+12817839998",
    img: "Phone Logo.png",
    text1: "Phone",
    text2: "+1 281 783 9998"
  }
];

// 动态生成轮播图内容
modulesData.forEach((data) => {
  const item = document.createElement('a');
  item.className = 'carousel-item';
  item.href = data.href;
  item.innerHTML = `
    <img src="${data.img}" alt="${data.text1}">
    <span>${data.text1}</span>
    <span>${data.text2}</span>
  `;
  carouselTrack.appendChild(item);
});

// 轮播图自动滚动逻辑
let isPlaying = true;
const speed = 1; // 滚动速度，单位：px
function animateCarousel() {
  if (isPlaying) {
    carouselTrack.scrollLeft += speed;
    if (carouselTrack.scrollLeft >= carouselTrack.scrollWidth - carouselTrack.offsetWidth) {
      carouselTrack.scrollLeft = 0; // 无限循环滚动
    }
  }
  requestAnimationFrame(animateCarousel);
}
animateCarousel();

// 播放/暂停按钮逻辑
const playPauseBtn = document.getElementById('playPauseBtn');
playPauseBtn.addEventListener('click', () => {
  isPlaying = !isPlaying;
  playPauseBtn.textContent = isPlaying ? 'Pause' : 'Play';
});
