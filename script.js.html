// 获取 DOM 元素
const mainModal = document.getElementById('main-modal');
const phoneModal = document.getElementById('phone-modal');

const downloadVCard = document.getElementById('download-vcard');
const sendPhoneButton = document.getElementById('send-phone');

const closeMainModal = document.getElementById('close-main-modal');
const closePhoneModal = document.getElementById('close-phone-modal');

const confirmPhone = document.getElementById('confirm-phone');
const cancelPhone = document.getElementById('cancel-phone');

const phoneError = document.getElementById('phone-error');
const phoneSuccess = document.getElementById('phone-success');

// 打开主模态框
downloadVCard.addEventListener('click', () => {
    mainModal.style.display = 'flex';
});

// 关闭主模态框
closeMainModal.addEventListener('click', () => {
    mainModal.style.display = 'none';
});

// 打开 Phone 模态框
sendPhoneButton.addEventListener('click', () => {
    mainModal.style.display = 'none';
    phoneModal.style.display = 'flex';
    resetPhoneModal();
});

// 关闭 Phone 模态框
closePhoneModal.addEventListener('click', () => {
    phoneModal.style.display = 'none';
});

// 取消 Phone 操作
cancelPhone.addEventListener('click', () => {
    phoneModal.style.display = 'none';
});

// 确认 Phone 操作并直接保存 vCard
confirmPhone.addEventListener('click', () => {
    resetPhoneModal();
    try {
        // 隐藏模态框
        phoneModal.style.display = 'none';

        // 跳转到 vCard 文件路径
        window.location.href = 'OliverF.vcf'; // 确保 vCard 文件与 index 在同一目录下

        phoneSuccess.textContent = 'Contact successfully saved to your phone.';
        phoneSuccess.style.display = 'block';
        phoneError.style.display = 'none';
        setTimeout(() => {
            phoneSuccess.style.display = 'none';
        }, 3000);
    } catch (error) {
        console.error("Error during file download:", error);
        phoneError.textContent = 'Failed to save contact.';
        phoneError.style.display = 'block';
        phoneSuccess.style.display = 'none';
        setTimeout(() => {
            phoneError.style.display = 'none';
        }, 3000);
    }
});

// 重置 Phone 模态提示
function resetPhoneModal() {
    phoneError.style.display = 'none';
    phoneSuccess.style.display = 'none';
}

// 点击模态框外部关闭
window.addEventListener('click', (event) => {
    if (event.target === mainModal) {
        mainModal.style.display = 'none';
    }
    if (event.target === phoneModal) {
        phoneModal.style.display = 'none';
    }
});

// =============================
//   5秒轮播 6部分社媒功能
// =============================
let carouselIndex = 0;

function moveCarousel() {
    const icons = document.querySelector('.contact-icons');
    const items = icons.querySelectorAll('a');
    const totalItems = items.length;

    carouselIndex = (carouselIndex + 1) % totalItems;
    const offset = -carouselIndex * 100; // 每次平移100%

    icons.style.transform = `translateX(${offset}%)`;
}

// 每5秒执行一次滚动
setInterval(moveCarousel, 5000);
// 立即初始化一次
moveCarousel();
